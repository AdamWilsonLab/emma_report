{"title":"Project Overview","markdown":{"yaml":{"title":"Project Overview"},"headingText":"Summary","containsRefs":false,"markdown":"\n\n\nThe EMMA project is building new tools to monitor the health of shrubland ecosystems in near real-time. Focusing on the fire-prone Cape Floristic Region of South Africa—a biodiversity hotspot—our system combines satellite data, field observations, and modeling to track changes in vegetation, identify threats like fires or invasive species, and support better conservation decisions. In partnership with the South African Environmental Observation Network (SAEON), EMMA aims to provide reliable, up-to-date information that helps protect these critical landscapes.\n\n```{r, echo=F, message=F,include=F, results=\"hide\", eval=T}\n#description: Modeling vegetation postfire recovery data\n\n\n# load data saved in the pipeline\n#tar_load(c(envdata, stan_data, model_results, spatial_outputs,model_prediction)) \nlibrary(targets)\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\nlibrary(leaflet)\nlibrary(forcats)\n\n# need to include all necessary targets here otherwise they aren't dependencies with tar_quarto()\ntar_load(protected_areas)\ntar_load(park_fire_history)\ntar_load(temp_directory)\ntar_load(years_since_fire_raster)\ntar_load(fires_wgs)\ntar_load(most_recent_ndvi_raster)\ntar_load(most_recent_ndvi_date)\ntar_load(monthly_mean_ndvi_raster)\ntar_load(monthly_delta_ndvi_raster)\ntar_load(weather_data)\ntar_load(report_qmd_dir) # forces park qmds to run first\n  \n```\n\n\n# Regional Overview\n\n```{r, echo=F, warning=F}\nprotected_areas_monthly_delta_ndvi <- extract(monthly_delta_ndvi_raster,protected_areas,fun=quantile,na.rm=T) |> \n  as_tibble() |> \n  select(-1) |> #drop the index\n  rename(\"Q0\"=\"NDVI\",\"Q25\"=\"NDVI.1\",\"Q50\"=\"NDVI.2\",\"Q75\"=\"NDVI.3\",\"Q100\"=\"NDVI.4\") |> \n  bind_cols(name=protected_areas$name)\n\n```\n\n```{r, echo=F, warning=F}\nprotected_areas_monthly_delta_ndvi |> \n  #gather(quantile,value,-name) |> \n  ggplot(aes(xmin=Q25,xmax=Q75,x=Q50,y=name))+\n    geom_errorbarh()\n\n```\n\n```{r, echo=F, warning=F}\nyears_since_fire <- extract(years_since_fire_raster,protected_areas,fun=quantile,na.rm=T) |> \n  as_tibble() |> \n  select(-1) |> #drop the index\n  rename(\"Q0\"=\"lyr.1\",\"Q25\"=\"lyr.1.1\",\"Q50\"=\"lyr.1.2\",\"Q75\"=\"lyr.1.3\",\"Q100\"=\"lyr.1.4\") |> \n  bind_cols(name=protected_areas$name)\n\n```\n# Stand Age distributions\n```{r, echo=F}\nyears_since_fire |> \n  filter(!is.na(Q50)) |> \n  mutate(name = fct_reorder(as.factor(name), Q50)) |> \n  ggplot(aes(y = name)) +\n    # Full range (min to max)\n    geom_segment(aes(x = Q0, xend = Q100, yend = name), color = \"grey70\", linewidth = .5) +\n    # Interquartile range (Q25 to Q75)\n    geom_segment(aes(x = Q25, xend = Q75, yend = name), color = \"grey40\", linewidth = 1) +\n    # Median point\n    geom_point(aes(x = Q50), size = 2, color = \"black\") +\n    labs(\n      x = \"Years Since Fire\",\n      y = NULL,\n      title = \"Distribution of Time Since Fire by Site\",\n      subtitle = \"Showing full range (Q0–Q100), IQR (Q25–Q75), and median (Q50)\"\n    ) \n\n```\n\n\n```{r, echo=F}\n  base_url <- \"https://adamwilsonlab.github.io/emma_report/reports/\"\n  base_url <- \"reports/\" #keep relative paths?\n  \n    reports <- \n  data.frame(report = list.files(\"reports/\")) %>%\n    mutate(url = paste(base_url,gsub(pattern = \".qmd\",replacement = \".html\",x = report),sep = \"\"),\n           park_name = gsub(pattern = \"report.\",replacement = \"\",x = report),\n           park_name = gsub(pattern = \".html\",replacement = \"\",x = park_name),\n           park_name = gsub(pattern = \".qmd\",replacement = \"\",x = park_name),\n           park_name = gsub(pattern = \"_\",replacement = \" \",x = park_name)) %>%\n      mutate(\n          park = glue::glue(\"[{park_name}]({url})\"),\n          park = map(park, gt::md))\n  \n  protected_areas <-\n  protected_areas %>%\n    st_as_sf() |> \n    inner_join(y = reports,\n               by = c(\"name\"=\"park_name\"))%>% \n    st_transform(crs = st_crs(4326))%>% \n   mutate(tag = paste0(\"Park: <a href=\", url,\">\",name , \"</a>\"))\n\n  bbox <- st_bbox(protected_areas) %>%\n  as.vector()\n\n\n```\n# Park-level Summaries\n\nClick on a park below to view park specific reports.\n\n```{r park_map, fig.width = 10, fig.height = 7, echo = FALSE, warning = FALSE, message = FALSE}\n\n\n  leaflet(data = protected_areas) %>%\n    addProviderTiles(providers$Esri.WorldImagery, group = \"World Imagery\") %>%\n    addProviderTiles(\"Esri.NatGeoWorldMap\", group = \"NatGeo\") %>%\n    #addProviderTiles(\"NASAGIBS.ModisTerraTrueColorCR\", group = \"True Colors\") %>%\n  addPolygons(color = \"black\",\n              stroke = TRUE,\n              fill = TRUE,\n              group = \"Park\",\n              popup = ~tag) %>%\n  addLayersControl(\n    baseGroups = c(\"NatGeo\",\"World Imagery\"),\n    options = layersControlOptions(collapsed = FALSE),position = \"topright\") %>%\n  fitBounds(bbox[1], bbox[2], bbox[3], bbox[4])\n\n```\n\n# Data Overview\n\nSee table below for dates each dataset was last updated and download links.\n\n```{r, echo=F, results='asis'}\n# build table of dates when products were last updated\n\ndates <- bind_rows(\n  data.frame(Description = \"Website\", Date = format(now(), \"%Y-%b-%d\")),\n  data.frame(Description = \"NDVI\", Date = format(most_recent_ndvi_date, \"%Y-%b-%d\")),\n  data.frame(Description = \"Weather\", Date = format(max(weather_data$YEARMODA), \"%Y-%b-%d\"))\n) |> \n  select(Description, \"Date last updated\"=Date)\n\nknitr::kable(dates)\n \n```\n","srcMarkdownNoYaml":"\n\n\n# Summary\nThe EMMA project is building new tools to monitor the health of shrubland ecosystems in near real-time. Focusing on the fire-prone Cape Floristic Region of South Africa—a biodiversity hotspot—our system combines satellite data, field observations, and modeling to track changes in vegetation, identify threats like fires or invasive species, and support better conservation decisions. In partnership with the South African Environmental Observation Network (SAEON), EMMA aims to provide reliable, up-to-date information that helps protect these critical landscapes.\n\n```{r, echo=F, message=F,include=F, results=\"hide\", eval=T}\n#description: Modeling vegetation postfire recovery data\n\n\n# load data saved in the pipeline\n#tar_load(c(envdata, stan_data, model_results, spatial_outputs,model_prediction)) \nlibrary(targets)\nlibrary(tidyverse)\nlibrary(sf)\nlibrary(terra)\nlibrary(leaflet)\nlibrary(forcats)\n\n# need to include all necessary targets here otherwise they aren't dependencies with tar_quarto()\ntar_load(protected_areas)\ntar_load(park_fire_history)\ntar_load(temp_directory)\ntar_load(years_since_fire_raster)\ntar_load(fires_wgs)\ntar_load(most_recent_ndvi_raster)\ntar_load(most_recent_ndvi_date)\ntar_load(monthly_mean_ndvi_raster)\ntar_load(monthly_delta_ndvi_raster)\ntar_load(weather_data)\ntar_load(report_qmd_dir) # forces park qmds to run first\n  \n```\n\n\n# Regional Overview\n\n```{r, echo=F, warning=F}\nprotected_areas_monthly_delta_ndvi <- extract(monthly_delta_ndvi_raster,protected_areas,fun=quantile,na.rm=T) |> \n  as_tibble() |> \n  select(-1) |> #drop the index\n  rename(\"Q0\"=\"NDVI\",\"Q25\"=\"NDVI.1\",\"Q50\"=\"NDVI.2\",\"Q75\"=\"NDVI.3\",\"Q100\"=\"NDVI.4\") |> \n  bind_cols(name=protected_areas$name)\n\n```\n\n```{r, echo=F, warning=F}\nprotected_areas_monthly_delta_ndvi |> \n  #gather(quantile,value,-name) |> \n  ggplot(aes(xmin=Q25,xmax=Q75,x=Q50,y=name))+\n    geom_errorbarh()\n\n```\n\n```{r, echo=F, warning=F}\nyears_since_fire <- extract(years_since_fire_raster,protected_areas,fun=quantile,na.rm=T) |> \n  as_tibble() |> \n  select(-1) |> #drop the index\n  rename(\"Q0\"=\"lyr.1\",\"Q25\"=\"lyr.1.1\",\"Q50\"=\"lyr.1.2\",\"Q75\"=\"lyr.1.3\",\"Q100\"=\"lyr.1.4\") |> \n  bind_cols(name=protected_areas$name)\n\n```\n# Stand Age distributions\n```{r, echo=F}\nyears_since_fire |> \n  filter(!is.na(Q50)) |> \n  mutate(name = fct_reorder(as.factor(name), Q50)) |> \n  ggplot(aes(y = name)) +\n    # Full range (min to max)\n    geom_segment(aes(x = Q0, xend = Q100, yend = name), color = \"grey70\", linewidth = .5) +\n    # Interquartile range (Q25 to Q75)\n    geom_segment(aes(x = Q25, xend = Q75, yend = name), color = \"grey40\", linewidth = 1) +\n    # Median point\n    geom_point(aes(x = Q50), size = 2, color = \"black\") +\n    labs(\n      x = \"Years Since Fire\",\n      y = NULL,\n      title = \"Distribution of Time Since Fire by Site\",\n      subtitle = \"Showing full range (Q0–Q100), IQR (Q25–Q75), and median (Q50)\"\n    ) \n\n```\n\n\n```{r, echo=F}\n  base_url <- \"https://adamwilsonlab.github.io/emma_report/reports/\"\n  base_url <- \"reports/\" #keep relative paths?\n  \n    reports <- \n  data.frame(report = list.files(\"reports/\")) %>%\n    mutate(url = paste(base_url,gsub(pattern = \".qmd\",replacement = \".html\",x = report),sep = \"\"),\n           park_name = gsub(pattern = \"report.\",replacement = \"\",x = report),\n           park_name = gsub(pattern = \".html\",replacement = \"\",x = park_name),\n           park_name = gsub(pattern = \".qmd\",replacement = \"\",x = park_name),\n           park_name = gsub(pattern = \"_\",replacement = \" \",x = park_name)) %>%\n      mutate(\n          park = glue::glue(\"[{park_name}]({url})\"),\n          park = map(park, gt::md))\n  \n  protected_areas <-\n  protected_areas %>%\n    st_as_sf() |> \n    inner_join(y = reports,\n               by = c(\"name\"=\"park_name\"))%>% \n    st_transform(crs = st_crs(4326))%>% \n   mutate(tag = paste0(\"Park: <a href=\", url,\">\",name , \"</a>\"))\n\n  bbox <- st_bbox(protected_areas) %>%\n  as.vector()\n\n\n```\n# Park-level Summaries\n\nClick on a park below to view park specific reports.\n\n```{r park_map, fig.width = 10, fig.height = 7, echo = FALSE, warning = FALSE, message = FALSE}\n\n\n  leaflet(data = protected_areas) %>%\n    addProviderTiles(providers$Esri.WorldImagery, group = \"World Imagery\") %>%\n    addProviderTiles(\"Esri.NatGeoWorldMap\", group = \"NatGeo\") %>%\n    #addProviderTiles(\"NASAGIBS.ModisTerraTrueColorCR\", group = \"True Colors\") %>%\n  addPolygons(color = \"black\",\n              stroke = TRUE,\n              fill = TRUE,\n              group = \"Park\",\n              popup = ~tag) %>%\n  addLayersControl(\n    baseGroups = c(\"NatGeo\",\"World Imagery\"),\n    options = layersControlOptions(collapsed = FALSE),position = \"topright\") %>%\n  fitBounds(bbox[1], bbox[2], bbox[3], bbox[4])\n\n```\n\n# Data Overview\n\nSee table below for dates each dataset was last updated and download links.\n\n```{r, echo=F, results='asis'}\n# build table of dates when products were last updated\n\ndates <- bind_rows(\n  data.frame(Description = \"Website\", Date = format(now(), \"%Y-%b-%d\")),\n  data.frame(Description = \"NDVI\", Date = format(most_recent_ndvi_date, \"%Y-%b-%d\")),\n  data.frame(Description = \"Weather\", Date = format(max(weather_data$YEARMODA), \"%Y-%b-%d\"))\n) |> \n  select(Description, \"Date last updated\"=Date)\n\nknitr::kable(dates)\n \n```\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"knitr"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["styles.css"],"toc":true,"output-file":"index.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.31","theme":"cosmo","title":"Project Overview"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}